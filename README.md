# LLM-Powered-Patent-Retrieval-Optimizer

This repository contains code for a patent retrieval system that uses embeddings from models such as SBERT and Anferico's BERT for patents. The system integrates with a Qdrant vector database to find similar patent documents based on search criteria and performs evaluation using metrics such as Precision, Recall, and Mean Reciprocal Rank (MRR).

Additionally, the repository provides utilities for converting the output from JSON format to Excel for easier review.

**Project Overview**

The system is designed to evaluate patent search results generated by two different models:

SBERT model: Uses Sentence-BERT embeddings (AI-Growth-Lab/PatentSBERTa) to encode the search criteria and retrieve relevant patents from Qdrant.
Anferico's BERT model: Uses the anferico/bert-for-patents model for embedding search criteria and retrieves patents.
The retrieved results are evaluated against a test set of patents for metrics like precision, recall, and MRR. The system outputs a JSON report, which can be further converted into an Excel format for analysis.

**Requirements**

To run the project, you need the following dependencies installed:

Python 3.8+
PyTorch
HuggingFace transformers library
qdrant-client for connecting to the Qdrant vector database
pandas for handling Excel file generation
json (Python Standard Library)
CUDA (Optional, but recommended for GPU acceleration)
Installation
Clone this repository:
git clone https://github.com/your-repo/patent-retrieval-system.git
cd patent-retrieval-system

Install the required dependencies:
pip install -r requirements.txt
Ensure that a Qdrant instance is running and accessible at the URL specified in the code (adjust the qdrant_url parameter if necessary).

Verify that the input JSON file with search criteria and test cases is available at the appropriate path.

**Usage**

1. Running the SBERT Test Report
The sbert_test_report.py script retrieves similar patent documents using the SBERT model and calculates evaluation metrics:

python sbert_test_report.py
Ensure that you update the file paths for the input JSON data and the output JSON file in the script as per your environment.

2. Running the Anferico Test Report
The anferico_test_report.py script does the same as the SBERT report but uses Anferico's BERT for patents model.

python anferico_test_report.py

3. Converting JSON to Excel
Once the retrieval and evaluation results are written into the output JSON, you can convert them into an Excel sheet using the test_output_json_to_excel.py script:


python test_output_json_to_excel.py
This will generate an Excel file containing all the relevant information from the JSON file for easier review and analysis.

**Scripts Description**

1. sbert_test_report.py
   
This script:

Loads the AI-Growth-Lab/PatentSBERTa model.
Retrieves patents based on search criteria provided in the input JSON file.
Evaluates results for Precision, Recall, and MRR.
Saves the results to an output JSON file.

2. anferico_test_report.py
   
This script:

Loads the anferico/bert-for-patents model.
Similar to the SBERT script, it retrieves patents and evaluates search results for precision, recall, and MRR.
Saves the output to the same or a different JSON file.

3. test_output_json_to_excel.py
   
This script:

Reads data from the output JSON file.
Converts the data into tabular form and writes it into an Excel file for better readability and reporting.
Output Files
JSON Output: Both the sbert_test_report.py and anferico_test_report.py scripts will save their results in a JSON file. The file contains:

**Search criteria**

Patent numbers and their positions in the retrieval results
Evaluation metrics (Precision, Recall, MRR)
Excel Output: The test_output_json_to_excel.py script converts the JSON output into an Excel file for easy access and review of the data.

